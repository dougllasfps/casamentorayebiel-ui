<section>

  <app-barra-navegacao></app-barra-navegacao>

  <form #pagamentoForm="ngForm" (ngSubmit)="onSubmit($event);" >
  <div class="container">
    <h1>~ Produtos selecionados ~</h1>
    <table class="table table-striped">
      <thead>
        <tr>
          <th scope="col"></th>
          <th scope="col">Descrição</th>
          <th scope="col">Valor</th>
          <th scope="col">Qtd</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of items">
          <td><img [src]="item.presente.img" class="mr-3" alt="..."></td>
          <td>{{item.presente.descricao}}</td>
          <td>{{item.presente.valor | currency: 'BRL'}}</td>
          <td><input [(ngModel)]="item.quantidade" 
                     (change)="calculaTotal()" 
                     type="number" 
                     name="quantidade"
                     class="form-control" 
                     id="qtd" 
                     min="1">
          </td>
        </tr>
        <tr *ngIf="items.length <= 0">
          <td colspan="3">
            Seu carrinho está vazio. <a routerLink="/presentes">Clique aqui para ver a lista de Presentes</a> 
          </td>
        </tr>
        <tr>
          <td colspan="2"></td>
          <td style="text-align: right;">TOTAL:</td>
          <td>{{carrinho.total | currency: 'BRL'}}</td>
        </tr>
      </tbody>
    </table>
    <br />
   
    <br>
    <hr class="style1">
    <br>
    <h2 *ngIf="items.length > 0">~ Formas de Pagamento ~</h2> <!--  Começa forma de pagamento -->
    <div class="tipopag" *ngIf="items.length > 0">
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio"  [(ngModel)]="pagamento.forma"  name="forma" id="deposito" value="deposito" >
        <label class="form-check-label" for="deposito">
          Depósito em conta
        </label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" [(ngModel)]="pagamento.forma" name="forma" id="cartao" value="cartao">
        <label class="form-check-label" for="cartao">
          Cartão de Crédito
        </label>
      </div>
      <div style="margin-top: 20px;"  *ngIf="pagamento.forma === 'deposito'">
        <input type="text" [(ngModel)]="carrinho.convidado" name="convidado" placeholder="Digite seu nome por favor." style="width: 20vw;">
        <button type="submit" class="btn btn-info" style="margin-left: 4px;">Depositar</button>
      </div>
    </div>
    <div class="container"  *ngIf="items.length > 0" >
      <div class="row" id="contacorrente" *ngIf="pagamento.forma === 'deposito'">
        <!-- Fechamento do Container das contas correntes -->
        <div class="card text-center col-12 col-sm-6">
          <div class="card-header">
            Gabriel Veras Miranda
          </div>
          <div class="card-body">
            <p class="card-text"><strong>Banco (260)</strong> - Nu Pagamentos S.A<br>
              <strong>Ag:</strong> 0001<br>
              <strong>Conta:</strong> 8589273-1 (Conta corrente)<br>
              <strong>CPF:</strong> 600.159.123-70</p>
            <br>
            <hr class="style1">
            <br>
            <p class="card-text"><strong>Banco</strong> - Caixa Econômica Federal<br>
              <strong>Ag:</strong> 1956<br>
              <strong>Conta:</strong> 64903-4<br>
              <strong>Op:</strong> 013 (Poupança)<br>
              <strong>CPF:</strong> 600.159.123-70</p>
          </div>
        </div>
        <div class="card text-center col-12 col-sm-6">
          <div class="card-header">
            Rayane Alves Moreira Sales
          </div>
          <div class="card-body">
            <p class="card-text">
              <strong>Banco (260)</strong> - Nu Pagamentos S.A<br>
              <strong>Ag:</strong> 0001<br>
              <strong>Conta:</strong> 7340956-1 (Conta corrente)<br>
              <strong>CPF:</strong> 020.778.983-56</p>
            <br>
            <hr class="style1">
            <br>
            <p class="card-text"><strong>Banco</strong> - Bradesco<br>
              <strong>Ag:</strong> 7737<br>
              <strong>Conta:</strong> 36112-7<br>
              <strong>CPF:</strong> 020.778.983-56</p>
          </div>
        </div>
      </div> <!-- Fechamento do Container das contas correntes -->

      <div class="cartao" id="cartao"  *ngIf="pagamento.forma === 'cartao'">
        <!-- Abrindo Pagamento com Cartão de crédito. -->
        <input type="text" name="nome" [(ngModel)]="carrinho.convidado" 
               class="form-control espaco" 
               placeholder="Digite seu nome." id="convidado">
        <input type="text" 
               matInput  mask="99999999999"  
              name="cpf" [(ngModel)]="pagamento.cpf" class="form-control espaco" 
              placeholder="Digite seu CPF." min="0" max="999" id="CPF">
        <input type="email" name="email"  [(ngModel)]="pagamento.emal" 
               class="form-control espaco" 
               placeholder="Digite seu e-mail." id="email">

        <br><br>
        <div class="row">
          <label class="col-12 total">Total: {{total | currency: 'BRL'}}</label></div>
        <select class="form-control form-control-lg espaco" 
                id="parcela" name="quantidadeParcelas" 
                [(ngModel)]="pagamento.quantidadeParcelas">
          <option value="1">01x de {{carrinho.total | currency: 'BRL'}}</option>
          <option value="2">02x de {{carrinho.total / 2 | currency: 'BRL'}} = {{carrinho.total | currency: 'BRL'}}</option>
          <option value="3">03x de {{carrinho.total / 3 | currency: 'BRL'}} = {{carrinho.total | currency: 'BRL'}}</option>
          <option value="4">04x De {{carrinho.total / 4 | currency: 'BRL'}} = {{carrinho.total | currency: 'BRL'}}</option>
          <option value="5">05x De {{carrinho.total / 5 | currency: 'BRL'}} = {{carrinho.total | currency: 'BRL'}}</option>
          <option value="6">06x De {{carrinho.total / 6 | currency: 'BRL'}} = {{carrinho.total | currency: 'BRL'}}</option>
          <option value="7">07x De {{carrinho.total / 7 | currency: 'BRL'}} = {{carrinho.total | currency: 'BRL'}}</option>
          <option value="8">08x De {{carrinho.total / 8 | currency: 'BRL'}} = {{carrinho.total | currency: 'BRL'}}</option>
          <option value="9">09x De {{carrinho.total / 9 | currency: 'BRL'}} = {{carrinho.total | currency: 'BRL'}}</option>
          <option value="10">10x de {{carrinho.total / 10 | currency: 'BRL'}} = {{carrinho.total | currency: 'BRL'}}</option>
          <option value="11">11x de {{carrinho.total / 11 | currency: 'BRL'}} = {{carrinho.total | currency: 'BRL'}}</option>
          <option value="12">12x de {{carrinho.total / 12 | currency: 'BRL'}} = {{carrinho.total | currency: 'BRL'}}</option>
        </select>
        <select class="form-control form-control-lg espaco" id="bandeira" name="bandeira" 
                [(ngModel)]="pagamento.cartao.bandeira" >
          <option value="master">MasterCard</option>
          <option value="visa">Visa</option>
        </select>
        <input type="text" matInput  mask="9999 9999 99999 99999" 
              name="numero" class="form-control espaco" 
              [(ngModel)]="pagamento.cartao.numero" id="numero" min="0"
              max="9999999999999999" ng-model-options="{allowInvalid:true}" ui-credit-card-mask
              placeholder="Número do Cartão de Crédito.">
        <input type="text" 
               matInput mask="999" 
               class="form-control espaco" 
               name="codigoSeguranca"
               [(ngModel)]="pagamento.cartao.codigoSeguranca"
               placeholder="Código de Segurança" 
               id="codigoSeguranca">
        <input type="text" 
               matInput  name="validade"
               [(ngModel)]="pagamento.cartao.validade"
               mask="99/9999" 
               class="form-control espaco" 
               placeholder="Data de Validade. ex: 14/2000" 
               id="validade">

        <input type="text" name="titular" [(ngModel)]="pagamento.cartao.titular" class="form-control espaco" placeholder="Nome do titular do cartão." id="titular">
        <br><br>
        <button type="submit" class="btn btn-info btnpagar">Efetuar Pagamento</button>
        <div id="feedback">
          <div *ngIf="mensagem" class="alert alert-success" role="alert">
            {{mensagem}}
          </div>
    
          <div *ngFor="let err of errors" class="alert alert-danger" role="alert">
            {{err}}
          </div>
        </div>
        <br><br><br>
      </div>
    </div><!-- Fechamento do Container das contas correntes -->
  </div>
</form>
</section>
